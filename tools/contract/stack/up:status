#!/usr/bin/env bash
# Contract: up:status - Show development environment status
set -euo pipefail

REPO_ROOT="$(cd "$(dirname "${BASH_SOURCE[0]}")/../../.." && pwd)"
cd "${REPO_ROOT}"

# Load .env if exists, then derive WORKTREE from directory name
if [[ -f .env ]]; then
    # shellcheck source=/dev/null
    source .env
fi
WORKTREE="$(basename "$(pwd)")"
export WORKTREE

if docker compose version &>/dev/null; then
  COMPOSE_CMD="docker compose"
else
  COMPOSE_CMD="docker-compose"
fi

echo "ðŸ“Š Environment Status (${WORKTREE})"
echo ""
${COMPOSE_CMD} -f docker-compose.worktree.yml ps
