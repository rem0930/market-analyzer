#!/usr/bin/env bash
# Contract: up:stop - Stop development environment
set -euo pipefail

REPO_ROOT="$(cd "$(dirname "${BASH_SOURCE[0]}")/../../.." && pwd)"
cd "${REPO_ROOT}"

# Load .env (contains WORKTREE and REPO_NAME)
if [[ -f .env ]]; then
    # shellcheck source=/dev/null
    source .env
fi
export WORKTREE="${WORKTREE:-main}"
export REPO_NAME="${REPO_NAME:-}"

if docker compose version &>/dev/null; then
  COMPOSE_CMD="docker compose"
else
  COMPOSE_CMD="docker-compose"
fi

echo "ðŸ›‘ Stopping development environment..."
${COMPOSE_CMD} -f docker-compose.worktree.yml down

echo "âœ… Environment stopped."
